{
  "index_patterns": ["fraud-alerts-*"],
  "priority": 999,
  "template": {
    "settings": {
      "index.number_of_shards": 1,
      "index.number_of_replicas": 0
    },
    "mappings": {
      "dynamic": "false",
      "properties": {
        "alertId": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
        },
        "eventId": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
        },
        "accountId": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
        },
        "cardId": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
        },

        "createdAt": { "type": "date" },
        "eventTime":  { "type": "date" },
        "scoredAt":   { "type": "date" },

        "amount":   { "type": "double" },
        "currency": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 32 } }
        },

        "fraudScore":      { "type": "double" },
        "fraudPrediction": { "type": "boolean" },

        "detectionMethod": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 64 } }
        },
        "severity": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 64 } }
        },

        "modelVersion": {
          "type": "text",
          "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
        },
        "inferenceMs": { "type": "double" },

        "reasons": { "type": "keyword" },

        "features": { "type": "object", "enabled": false },
        "featureContributions": { "type": "object", "enabled": false }
      }
    }
  }
}
